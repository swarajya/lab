FROM php:7.3-apache
ARG DEBIAN_FRONTEND=noninteractive

RUN apt-get update && apt-get install -y \
    build-essential \
    mariadb-client \    
    locales \
    zip \    
    vim \
    unzip \
    git \
    curl \    
    supervisor


RUN DEBIAN_FRONTEND=noninteractive apt-get -y dist-upgrade
RUN DEBIAN_FRONTEND=noninteractive apt-get -y install python-software-properties
RUN DEBIAN_FRONTEND=noninteractive apt-get -y install software-properties-common
RUN DEBIAN_FRONTEND=noninteractive LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php

RUN apt-get update -yqq \
    && apt-get install -yqq \
  php7.3-pgsql \
	php7.3-mysql \
	php7.3-opcache \
	php7.3-common \
	php7.3-mbstring \
	php7.3-soap \
	php7.3-cli \
	php7.3-intl \
	php7.3-json \
	php7.3-xsl \
	php7.3-imap \
	php7.3-ldap \
	php7.3-curl \
	php7.3-gd  \
	php7.3-dev \
  php7.3-fpm \
  php7.3-bcmath \
  php7.3-imagick \
  php7.3-zip \
  php7.3-zmq \
  php7.3-apcu \
  && apt-get install pkg-config \
  && pecl install mongodb \
  && echo "extension=mongodb.so" > /etc/php/7.3/cli/conf.d/ext-mongodb.ini \
  && echo "extension=mongodb.so" > /etc/php/7.3/fpm/conf.d/ext-mongodb.ini \
  && apt-get install -y -q --no-install-recommends \
     ssmtp

RUN a2enmod rewrite
RUN a2enmod ssl
RUN a2enmod proxy

RUN service apache2 restart

#RUN docker-php-ext-install intl
COPY --chown=www-data:www-data . /var/www/html/ 
COPY ./vhost.conf /etc/apache2/sites-available/000-default.conf 

WORKDIR /var/www/html
EXPOSE 80


